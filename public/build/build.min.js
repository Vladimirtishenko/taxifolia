function SiteModel(){}function SiteController(){"use strict";this.registrationModule(),this.registrationSimpleHandler({element:".taxifolia-discus-link",event:"click",classRequest:"Modal",classMethod:"discusTemplate",params:"discus"})}function handlerToLoad(){"use strict";new SiteController}function TopSlider(t){"use strict";return t?(this.element=t.firstElementChild,this.children=this.element.children,this.count=this.children.length,this.current=0,this.constructControls(),void this.addEventListeners()):!1}function CommentSlider(t){"use strict";return t?(this.element=t,this.children=this.element.children,this.count=this.children.length,this.current=0,this.state=!0,this.addStyleWidth(),void this.addEventListeners()):!1}function Modal(){}function Brakets(t){"use strict";return t?(this.form=t,this.text=document.querySelector(".taxifolia-description-form-script-replace > span"),void this.addEventListeners()):!1}SiteModel.prototype.FactoryXHR=function(){"use strict";var t;try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(i){t=!1}}return t||"undefined"==typeof XMLHttpRequest||(t=new XMLHttpRequest),t},SiteModel.prototype.Xhr=function(t,e,i,n,o){"use strict";var r=this.FactoryXHR();r.onreadystatechange=function(t){200===r.status&&4===r.readyState&&n(r.responseText,o)},console.log(i),r.open(t,e,!0),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.send(i)},SiteController.prototype=Object.create(SiteModel.prototype),SiteController.prototype.registrationModule=function(){"use strict";this.TopSlider=new TopSlider(document.querySelector(".taxifolia-top-slider")),this.CommentSlider=new CommentSlider(document.querySelector(".taxifolia-slider-comments-list")),this.Modal=new Modal,this.Brakets=new Brakets(document.querySelector(".taxifolia-backets-responsive")),$(".taxifolia-link-menu").on("click",function(t){t.preventDefault(),$("html,body").animate({scrollTop:$(this.hash).offset().top},500)});var t=$("#taxifolia-carousel").waterwheelCarousel();$("#taxifolia-carousel-prev").bind("click",function(){return t.prev(),!1}),$("#taxifolia-carousel-next").bind("click",function(){return t.next(),!1})},SiteController.prototype.registrationSimpleHandler=function(){"use strict";for(var t=arguments,e=0;e<t.length;e++)if(t[e]instanceof Object&&5==Object.keys(t[e]).length){var i=document.querySelector(t[e].element);i.addEventListener(t[e].event,this[t[e].classRequest][t[e].classMethod].bind(this.Modal))}},window.addEventListener("DOMContentLoaded",handlerToLoad),TopSlider.prototype=Object.create(SiteController.prototype),TopSlider.prototype.constructControls=function(){"use strict";for(var t,e='<div class="taxifolia-top-slider-controls">',i=this,n=0;n<this.count;n++)this.children[n].setAttribute("data-slide",n),t=0==n?"-active":"",e+='<span class="taxifolia-top-slider-controls-item '+t+'" data-number="'+n+'"></span>';e+="</div>";try{return i.element.parentNode.insertAdjacentHTML("beforeend",e),!0}catch(o){throw Error("No Slides")}},TopSlider.prototype.addEventListeners=function(){"use strict";var t=document.querySelector(".taxifolia-top-slider-controls");t.addEventListener("click",this.handlerToListeners.bind(this))},TopSlider.prototype.handlerToListeners=function(){"use strict";var t=event.target,e="string"==typeof t.getAttribute("data-number")?parseInt(t.getAttribute("data-number")):null,i=this.element.parentNode.querySelector(".-active"),n=this.element.parentNode.clientHeight;null==e||t.classList.contains("-active")||(this.element.style.cssText="transform: translateY("+n*-e+"px)",this.current=e,i.classList.remove("-active"),t.classList.add("-active"))},CommentSlider.prototype=Object.create(SiteController.prototype),CommentSlider.prototype.addEventListeners=function(){"use strict";var t=document.querySelector(".taxifolia-slider-comments-controls");t.addEventListener("click",this.handlerToListeners.bind(this))},CommentSlider.prototype.addStyleWidth=function(){"use strict";this.element.style.cssText+="width: "+100*this.count+"%",[].forEach.call(this.children,function(t){t.style.width=100/this.count+"%"}.bind(this))},CommentSlider.prototype.handlerToListeners=function(){"use strict";var t=event.target,e=t.getAttribute("data-arrow"),i=this,n=i.element.firstElementChild.clientWidth;e&&1==i.state&&(i.state=!1,"prev"==e?(i.element.insertBefore(i.element.lastElementChild,i.element.firstElementChild),i.element.style.cssText+="transform: translateX("+-n+"px)",setTimeout(function(){i.element.style.cssText+="transition: .5s; transform: translateX(0px)",i.animation(null)},20)):(i.element.style.cssText+="transition: .5s; transform: translateX("+-n+"px)",i.animation("appendChild",i.element.firstElementChild)))},CommentSlider.prototype.animation=function(t,e){"use strict";var i=this;setTimeout(function(){t&&i.element[t](e),i.element.style.cssText+="transition-duration: 0s; transform: translateX(0)",i.state=!0},600)},Modal.prototype=Object.create(SiteController.prototype),Modal.prototype.responseModal=function(t,e){var i=document.querySelector(".taxifolia-modal"),n=i.firstElementChild;n.insertAdjacentHTML("beforeend",t+"<a class='taxifolia-modal-closes'></a>"),i.classList.add("taxifolia-modal-flex","taxifolia-modal-animate-in"),e(),this.createClose(i,n,"disqus")},Modal.prototype.discusTemplate=function(){var t="<div id='disqus_thread'></div>",e=function(){var t=document,e=t.createElement("script");e.src="//taxi1989.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)};this.responseModal(t,e)},Modal.prototype.mailResponse=function(){console.log("mailResponse")},Modal.prototype.createClose=function(t,e,i){var n=t.querySelector(".taxifolia-modal-closes");n&&n.addEventListener("click",this.closeHandler.bind(this,t,e,i))},Modal.prototype.closeHandler=function(t,e,i){t.classList.add("taxifolia-modal-animate-out"),setTimeout(function(){if(t.classList.remove("taxifolia-modal-flex","taxifolia-modal-animate-in","taxifolia-modal-animate-out"),e.innerHTML="",i)for(var n=document.querySelectorAll('script[src*="'+i+'"]'),o=0;o<n.length;o++)n[o].parentNode.removeChild(n[o])},800)},Brakets.prototype=Object.create(SiteController.prototype),Brakets.prototype.addEventListeners=function(){"use strict";this.form.addEventListener("submit",this.HandletToSubmit.bind(this)),this.form.addEventListener("change",this.HandletToInput.bind(this))},Brakets.prototype.HandletToSubmit=function(t){t.preventDefault();var e=this.surializer(t.target);this.Xhr("POST","mail.php",e,this.calbackToLoadModal,this)},Brakets.prototype.HandletToInput=function(t){var e=t&&t.target;e&&"radio"==e.getAttribute("type")&&(this.text.innerHTML=e.value)},Brakets.prototype.surializer=function(t){for(var e=t.elements,i="",n=0;n<e.length;n++)("radio"!=e[n].type||e[n].checked)&&e[n].name&&(i+=e[n].name+"="+e[n].value+"&");return i.slice(0,-1)},Brakets.prototype.calbackToLoadModal=function(t,e){var t=JSON.parse(t),i="Ваше сообщение отправлено спасибо! Мы с вами свяжемся в течении часа",n="Ваше сообщение не отправлено что то пошло не так, попробуйте снова.",o=200==t.status?i:n,r=e.form.querySelector(".taxifolia-mail-form-flex-input");r.insertAdjacentHTML("beforeend",'<p class="taxifolia-notify">'+o+"</p>"),e.form.reset()},function(t){"use strict";t.fn.waterwheelCarousel=function(e){function i(){C={itemsContainer:t(g),totalItems:t(g).find("img").length,containerWidth:t(g).width(),containerHeight:t(g).height(),currentCenterItem:null,previousCenterItem:null,items:[],calculations:[],carouselRotationsLeft:0,currentlyMoving:!1,itemsAnimating:0,currentSpeed:y.speed,intervalTimer:null,currentDirection:"forward",leftItemsCount:0,rightItemsCount:0,performingSetup:!0},C.itemsContainer.find("img").removeClass(y.activeClassName)}function n(t){clearTimeout(C.autoPlayTimer),t||0===y.autoPlay||(C.autoPlayTimer=setTimeout(function(){v(y.autoPlay>0?"forward":"backward")},Math.abs(y.autoPlay)))}function o(e){if(y.preloadImages===!1)return void e();var i=C.itemsContainer.find("img"),n=0,o=i.length;i.each(function(){t(this).bind("load",function(){return n+=1,n===o?void e():void 0}),t(this).attr("src",t(this).attr("src")),this.complete&&t(this).trigger("load")})}function r(){C.itemsContainer.find("img").each(function(){(void 0==t(this).data("original_width")||y.forcedImageWidth>0)&&t(this).data("original_width",t(this).width()),(void 0==t(this).data("original_height")||y.forcedImageHeight>0)&&t(this).data("original_height",t(this).height())})}function a(){y.forcedImageWidth&&y.forcedImageHeight&&C.itemsContainer.find("img").each(function(){t(this).width(y.forcedImageWidth),t(this).height(y.forcedImageHeight)})}function s(){C.itemsContainer.find("img:first");C.calculations[0]={distance:0,offset:0,opacity:1};for(var t=y.horizonOffset,e=y.separation,i=1;i<=y.flankingItems+2;i++)i>1&&(t*=y.horizonOffsetMultiplier,e*=y.separationMultiplier),C.calculations[i]={distance:C.calculations[i-1].distance+e,offset:C.calculations[i-1].offset+t,opacity:C.calculations[i-1].opacity*y.opacityMultiplier};y.edgeFadeEnabled?C.calculations[y.flankingItems+1].opacity=0:C.calculations[y.flankingItems+1]={distance:0,offset:0,opacity:0}}function l(){C.items=C.itemsContainer.find("img");for(var e=0;e<C.totalItems;e++)C.items[e]=t(C.items[e]);0===y.horizon&&("horizontal"===y.orientation?y.horizon=C.containerHeight/2:y.horizon=C.containerWidth/2),C.itemsContainer.css("position","relative").find("img").each(function(){var e,i;"horizontal"===y.orientation?(e=C.containerWidth/2-t(this).data("original_width")/2,i=y.horizon-t(this).data("original_height")/2):(e=y.horizon-t(this).data("original_width")/2,i=C.containerHeight/2-t(this).data("original_height")/2),t(this).css({left:e,right:"inherit",top:i,visibility:"visible",position:"absolute","z-index":0,opacity:0}).data({top:i,left:e,oldPosition:0,right:"inherit",currentPosition:0,depth:0,opacity:0}).show()})}function c(){y.startingItem=0===y.startingItem?Math.round(C.totalItems/2):y.startingItem,C.rightItemsCount=Math.ceil((C.totalItems-1)/2),C.leftItemsCount=Math.floor((C.totalItems-1)/2),C.carouselRotationsLeft=1,u(C.items[y.startingItem-1],0),C.items[y.startingItem-1].css("opacity",1);for(var t=y.startingItem-1,e=1;e<=C.rightItemsCount;e++)t<C.totalItems-1?t+=1:t=0,C.items[t].css("opacity",1),u(C.items[t],e);for(var t=y.startingItem-1,e=-1;e>=-1*C.leftItemsCount;e--)t>0?t-=1:t=C.totalItems-1,C.items[t].css("opacity",1),u(C.items[t],e)}function d(t,e){var i=Math.abs(e);if(i<y.flankingItems+1)var n=C.calculations[i];else var n=C.calculations[y.flankingItems+1];var o=Math.pow(y.sizeMultiplier,i),r=o*t.data("original_width"),a=o*t.data("original_height"),s=(Math.abs(t.width()-r),Math.abs(t.height()-a),n.offset),l=n.distance;if(0>e&&(l*=-1),"horizontal"==y.orientation)var c=C.containerWidth/2,d=c+l-r/2,u=y.horizon-s-a/2;else var c=C.containerHeight/2,d=y.horizon-s-r/2,u=c+l-a/2;var h;h=0===e?1:n.opacity;var m=y.flankingItems+2-i;t.data("width",r),t.data("height",a),t.data("top",u),t.data("left",d),t.data("oldPosition",t.data("currentPosition")),t.data("depth",m),t.data("opacity",h)}function u(t,e){Math.abs(e)<=y.flankingItems+1?(d(t,e),C.itemsAnimating++,t.css("z-index",t.data().depth).animate({left:t.data().left,width:t.data().width,height:t.data().height,top:t.data().top,opacity:t.data().opacity},C.currentSpeed,y.animationEasing,function(){h(t,e)})):(t.data("currentPosition",e),0===t.data("oldPosition")&&t.css({left:t.data().left,width:t.data().width,height:t.data().height,top:t.data().top,opacity:t.data().opacity,"z-index":t.data().depth}))}function h(t,e){C.itemsAnimating--,t.data("currentPosition",e),0===e&&(C.currentCenterItem=t),0===C.itemsAnimating&&(C.carouselRotationsLeft-=1,C.currentlyMoving=!1,C.carouselRotationsLeft>0?m(0):(C.currentSpeed=y.speed,C.currentCenterItem.addClass(y.activeClassName),C.performingSetup===!1&&(y.movedToCenter(C.currentCenterItem),y.movedFromCenter(C.previousCenterItem)),C.performingSetup=!1,n()))}function m(e){if(C.currentlyMoving===!1){C.currentCenterItem.removeClass(y.activeClassName),C.currentlyMoving=!0,C.itemsAnimating=0,C.carouselRotationsLeft+=e,y.quickerForFurther===!0&&(e>1&&(C.currentSpeed=y.speed/e),C.currentSpeed=C.currentSpeed<100?100:C.currentSpeed);for(var i=0;i<C.totalItems;i++){var n,o=t(C.items[i]),r=o.data("currentPosition");n="forward"==C.currentDirection?r-1:r+1;var a=n>0?C.rightItemsCount:C.leftItemsCount;Math.abs(n)>a&&(n=-1*r,C.totalItems%2==0&&(n+=1)),u(o,n)}}}function f(){var t=C.currentCenterItem.next();return t.length<=0&&(t=C.currentCenterItem.parent().children().first()),t}function p(){var t=C.currentCenterItem.prev();return t.length<=0&&(t=C.currentCenterItem.parent().children().last()),t}function v(t){C.currentlyMoving===!1&&(C.previousCenterItem=C.currentCenterItem,y.movingFromCenter(C.currentCenterItem),"backward"==t?(y.movingToCenter(p()),C.currentDirection="backward"):"forward"==t&&(y.movingToCenter(f()),C.currentDirection="forward")),m(1)}if(this.length>1)return this.each(function(){t(this).waterwheelCarousel(e)}),this;var g=this,y={},C={};return t(this).find("img").bind("click",function(){var e=t(this).data().currentPosition;if(0!=y.imageNav&&!(Math.abs(e)>=y.flankingItems+1||C.currentlyMoving)){C.previousCenterItem=C.currentCenterItem,n(!0),y.autoPlay=0;var i=Math.abs(e);0==e?y.clickedCenter(t(this)):(y.movingFromCenter(C.currentCenterItem),y.movingToCenter(t(this)),0>e?(C.currentDirection="backward",m(i)):e>0&&(C.currentDirection="forward",m(i)))}}),t(this).find("a").bind("click",function(t){return t.preventDefault(),!1}),t(document).keydown(function(t){return y.keyboardNav&&(37===t.which&&"horizontal"==y.orientation||38===t.which&&"vertical"==y.orientation?(n(!0),y.autoPlay=0,v("backward")):(39===t.which&&"horizontal"==y.orientation||40===t.which&&"vertical"==y.orientation)&&(n(!0),y.autoPlay=0,v("forward")),y.keyboardNavOverride&&("horizontal"==y.orientation&&(37===t.which||39===t.which)||"vertical"==y.orientation&&(38===t.which||40===t.which)))?(t.preventDefault(),!1):void 0}),this.reload=function(e){if("object"==typeof e);else;y=t.extend({},t.fn.waterwheelCarousel.defaults,e),i(),C.itemsContainer.find("img").hide(),a(),o(function(){r(),s(),l(),c()})},this.next=function(){n(!0),y.autoPlay=0,v("forward")},this.prev=function(){n(!0),y.autoPlay=0,v("backward")},this.reload(e),this},t.fn.waterwheelCarousel.defaults={startingItem:1,separation:175,separationMultiplier:.6,horizonOffset:0,horizonOffsetMultiplier:1,sizeMultiplier:.7,opacityMultiplier:.8,horizon:0,flankingItems:3,speed:300,animationEasing:"linear",quickerForFurther:!0,edgeFadeEnabled:!1,linkHandling:2,autoPlay:0,orientation:"horizontal",activeClassName:"carousel-center",keyboardNav:!1,keyboardNavOverride:!0,imageNav:!0,preloadImages:!0,forcedImageWidth:0,forcedImageHeight:0,movingToCenter:t.noop,movedToCenter:t.noop,clickedCenter:t.noop,movingFromCenter:t.noop,movedFromCenter:t.noop}}(jQuery);